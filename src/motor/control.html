<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Pico W Motor Control</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 40px; }
    .grid { display: inline-grid; grid-template-columns: 80px 80px 80px; gap: 10px; }
    button { padding: 15px; font-size: 18px; }
    #status { margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Pico W Motor Control</h1>
  <p>Use buttons or WASD keys (focus this page).</p>

  <label>
    Pico IP:
    <input id="ip" value="10.110.0.51" size="15">
  </label>

  <div class="grid">
    <div></div>
    <button onclick="sendCmd('F')">W<br>Forward</button>
    <div></div>

    <button onclick="sendCmd('L')">A<br>Left</button>
    <button onclick="sendCmd('S')">Stop</button>
    <button onclick="sendCmd('R')">D<br>Right</button>

    <div></div>
    <button onclick="sendCmd('B')">S<br>Back</button>
    <div></div>
  </div>

  <div id="status"></div>

  <script>
    function sendCmd(c) {
      const ip = document.getElementById('ip').value.trim();
      if (!ip) return;
      fetch(`http://${ip}/cmd?c=${c}`)
        .then(r => r.text())
        .then(t => {
          document.getElementById('status').textContent = 'Sent: ' + c + ' (' + t + ')';
        })
        .catch(err => {
          document.getElementById('status').textContent = 'Error: ' + err;
        });
    }

    document.addEventListener('keydown', (e) => {
      const key = e.key.toLowerCase();
      if (key === 'w') sendCmd('F');
      else if (key === 's') sendCmd('B');
      else if (key === 'a') sendCmd('L');
      else if (key === 'd') sendCmd('R');
      else if (key === ' ') sendCmd('S');
    });

    document.addEventListener('keyup', (e) => {
      const key = e.key.toLowerCase();
      if (['w','a','s','d'].includes(key)) {
        sendCmd('S'); // stop when key released
      }
    });
  </script>
</body>
</html>